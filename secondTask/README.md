# Реализация методов аппроксимации сплайнами на Maple

Кубические и B сплайны являются хорошими инструментами для аппроксимации и моделирования гладких кривых. Каждый из типов обладает своими особенностями, некоторые из них описаны ниже:
- Изменение одного из узлов кубического сплайна влияет на форму всей кривой в то время как изменение узла B сплайна оказывает только локальное воздействие
- Кубические и B сплайны обеспечивают высокую степень гладкости кривой
- B сплайны менее чувствительны к шуму данных
- Кубические сплайны создают кривую, которая проходит через все заданные узлы данных. Кубический сплайн также подразумевает гладкость первйо и второй производных
- B сплайны не обязательно проходят через все заданные точки данных. Они аппроксимируют общую форму набора данных, создавая гладкую кривую
- Преимуществом B сплайнов является их гибкость в плане управления кривой с помощью контрольных точек и кривой, что делает их хорошим инструментом для моделирования сложных функций с локальными выбросами _(однако в нашем эксперименте это не затронется)_
- При этом стоит учитывать, что B сплайны предназначены для "динамической аппроксимации" и показывают лучшие свои качестве при наибольшем количестве узлов. В случае же нашей сетки, часто можно наблюдать отклонения у левой границы интервала из-за дефицита контрольных точек
- Можно было добиться того, чтобы в B сплайне аппроксимируемые значения в граничных точках совпадали с реальным за счет увеличения степени этих точек (порядок базисных функций + 1). Однако иногда лучший результат дает немного другой подход, при котором вместо увеличения степени граничных точек, узловой вектор расширяется дополнительными значениями с известным шагом $0.1$

## Экспермент

### Анализ графиков

1. $\sqrt{x}$ - Демонстрирует недостаток рассматриваемых сплайнов в виде отклонения на левой границе интервала _(для некоторых функции)_
- #### Кубический сплайн
![](pic/cubic_sqrt.png)
- #### B сплайн
![](pic/b_sqrt.png)

2. $\sin{(50x)}$ - демонстрация того, что для функций с высокой частотой колебаний при ограниченном количестве точек результат будет плачевным. Оба сплайна создают кривые, повторяющие форму исходной, но с гораздо меньшим периодом _(а в случае B сплайна и высота колебаний будет отличаться)_
- #### Кубический сплайн
![](pic/cubic_sin50.png)
- #### B сплайн
![](pic/b_sin50.png)

3. $\sin(20*\pi*x)$ - усиленный гиперболизированный п.2, когда из-за ограниченного и равнораспределенного вектора узлов получаем константу на исследуемом интервале
- #### Кубический сплайн
![](pic/cubic_sin20pi.png)
- ### B сплайн
![](pic/b_sin20.pi.png)

4. $\exp(\frac{1}{(x+0.4)^2})$ - характерно показывает, что размер ошибки пропорционален величине функции и что B сплайн при малом количестве контрольных узлов на некоторых функциях может вести себя заметно хуже кубического на границе интервала _(об этом было написано буквально в каждой прочитанной мной статье)_. Зато дальше, в отличие от кубического сплайна, отклонений не наблюдалось

- ### Кубический сплайн
![](pic/cub_exp.png)

- ### B сплайн
![](pic/b_exp.png)

Для доказательства того, что данные сплайны способны при данном узловом векторе качественно аппроксимировать какие то функции и что реализации алгоритмов не ошибочны, приведу несколько "хороших" примеров аппроксимации
### Удачные для аппроксимации функции

- #### $\ln(x+1)$, кубический
![](pic/cub_ln.png)

- #### $\sin(6x)$, B
![](pic/b_sin6x.png)

- #### $x^4$, кубический
![](pic/cubic_x4png.png)


### Сравнение ошибок

|  | Кубический сплайн | B сплайн |
| --- | --- | --- |
| $\sqrt{x}$ | 0.0690160 | 0.0725332 |
| $\sin{50x}$ | 1.9757805 | 3.2052919 |
| $\sin(20*\pi * x)$ | 0.9510564 | 0.9510565 |
| $\exp{\frac {1} {(x + 0.4) ^ 2}}$ | 125.21267 | 174.43192

Можно заметить, что в данном эксперименте лучше себя проявил кубический сплайн, что неудивительно, поскольку в этот раз никак не учитывались сильные стороны B сплайна, а на результат сильно влияли отклонения на левой границе интервала.

### Источники вдохновения
- [Cubic Spline Interpolation, Sky McLiney and Megan Levine](https://www.rajgunesh.com/resources/downloads/numerical/cubicsplineinterpol.pdf)
- [B-Spline Interpolation on Lattices](https://www.geometrictools.com/Documentation/BSplineInterpolation.pdf)
- [Theory and Practice of Image B-Spline Interpolation](https://enpc.hal.science/hal-01846912/document)
- [Cubic Spline Interpolation](https://blog.timodenk.com/cubic-spline-interpolation/index.html)